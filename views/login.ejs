<!DOCTYPE html>
<html lang="id">
<head>
  <%- include('partials/head') %>
  <style>
    .role-card { transition: all 0.3s ease; }
    .role-card:hover { transform: translateY(-3px); }
    .role-card.selected { border-color: #8E9196; background-color: #F8FAFC; }
    .role-card.selected .role-icon { background-color: #8E9196; color: white; }
  </style>
</head>
<body class="min-h-screen bg-slate-bg flex">

  <!-- Left: Branding Panel -->
  <div class="hidden lg:flex lg:w-1/2 bg-sma-grey relative overflow-hidden flex-col justify-center items-center text-center px-12">
    <div class="absolute top-0 right-0 w-96 h-96 bg-white opacity-5 rounded-full -mr-48 -mt-48 blur-3xl"></div>
    <div class="absolute bottom-0 left-0 w-64 h-64 bg-blue-300 opacity-10 rounded-full -ml-32 -mb-32 blur-2xl"></div>

    <div class="relative z-10 max-w-md" data-aos="fade-right">
      <div class="flex items-center justify-center gap-3 mb-10">
        <div class="w-14 h-14 bg-white/20 backdrop-blur-sm rounded-2xl flex items-center justify-center text-white text-3xl font-bold">E</div>
        <div class="text-left">
          <h1 class="text-2xl font-bold text-white leading-none">E-Rapor</h1>
          <span class="text-sm text-white/70 font-medium tracking-wider">& Career Bridge</span>
        </div>
      </div>

      <h2 class="text-4xl font-extrabold text-white leading-tight mb-6 text-balance">
        Akses Platform Akademik Digital Anda
      </h2>

      <p class="text-white/60 leading-relaxed mb-10">
        Satu ekosistem yang menghubungkan guru, siswa, dan admin dalam mengelola data akademik secara efisien dan terverifikasi.
      </p>

      <!-- Feature Pills -->
      <div class="flex flex-wrap justify-center gap-3">
        <div class="bg-white/10 backdrop-blur-sm px-4 py-2 rounded-full flex items-center gap-2">
          <i class="fa-solid fa-shield-halved text-white/80 text-xs"></i>
          <span class="text-white/80 text-sm font-medium">QR Verification</span>
        </div>
        <div class="bg-white/10 backdrop-blur-sm px-4 py-2 rounded-full flex items-center gap-2">
          <i class="fa-solid fa-file-excel text-white/80 text-xs"></i>
          <span class="text-white/80 text-sm font-medium">Excel Import</span>
        </div>
        <div class="bg-white/10 backdrop-blur-sm px-4 py-2 rounded-full flex items-center gap-2">
          <i class="fa-solid fa-id-card text-white/80 text-xs"></i>
          <span class="text-white/80 text-sm font-medium">Auto CV</span>
        </div>
      </div>
    </div>
  </div>

  <!-- Right: Login Form -->
  <div class="flex-1 flex items-center justify-center p-6 lg:p-12">
    <div class="w-full max-w-md" data-aos="fade-left">
      <!-- Mobile Logo -->
      <div class="lg:hidden flex items-center gap-3 mb-8">
        <div class="w-10 h-10 bg-sma-grey rounded-xl flex items-center justify-center text-white text-xl font-bold shadow-lg">E</div>
        <div>
          <h1 class="text-lg font-bold text-gray-800 leading-none">E-Rapor</h1>
          <span class="text-xs text-sma-grey font-medium tracking-wider">& Career Bridge</span>
        </div>
      </div>

      <div class="mb-8">
        <h2 class="text-2xl font-bold text-gray-800 mb-2">Masuk ke Akun Anda</h2>
        <p class="text-sm text-gray-500">Pilih role dan masukkan kredensial untuk melanjutkan.</p>
      </div>

      <% if (typeof error !== 'undefined' && error) { %>
        <div class="bg-red-50 border border-red-200 text-red-600 px-4 py-3 rounded-xl text-sm mb-6 flex items-center gap-2">
          <i class="fa-solid fa-circle-exclamation"></i>
          <span><%= error %></span>
        </div>
      <% } %>

      <form action="/auth/login" method="POST" class="space-y-6">
        <!-- Role Selection -->
        <div>
          <label class="text-xs font-semibold text-gray-500 uppercase tracking-wider mb-3 block">Pilih Role</label>
          <div class="grid grid-cols-3 gap-3">
            <label class="role-card cursor-pointer border-2 border-gray-200 rounded-2xl p-4 text-center block <%= typeof selectedRole !== 'undefined' && selectedRole === 'siswa' ? 'selected' : '' %>" onclick="selectRole(this, 'siswa')">
              <input type="radio" name="role" value="siswa" class="hidden" <%= typeof selectedRole !== 'undefined' && selectedRole === 'siswa' ? 'checked' : '' %>>
              <div class="role-icon w-12 h-12 bg-blue-50 text-blue-500 rounded-xl flex items-center justify-center mx-auto mb-2">
                <i class="fa-solid fa-graduation-cap text-lg"></i>
              </div>
              <span class="text-xs font-bold text-gray-700">Siswa</span>
            </label>

            <label class="role-card cursor-pointer border-2 border-gray-200 rounded-2xl p-4 text-center block <%= typeof selectedRole !== 'undefined' && selectedRole === 'guru' ? 'selected' : '' %>" onclick="selectRole(this, 'guru')">
              <input type="radio" name="role" value="guru" class="hidden" <%= typeof selectedRole !== 'undefined' && selectedRole === 'guru' ? 'checked' : '' %>>
              <div class="role-icon w-12 h-12 bg-green-50 text-green-500 rounded-xl flex items-center justify-center mx-auto mb-2">
                <i class="fa-solid fa-chalkboard-user text-lg"></i>
              </div>
              <span class="text-xs font-bold text-gray-700">Guru</span>
            </label>

            <label class="role-card cursor-pointer border-2 border-gray-200 rounded-2xl p-4 text-center block <%= typeof selectedRole !== 'undefined' && selectedRole === 'admin' ? 'selected' : '' %>" onclick="selectRole(this, 'admin')">
              <input type="radio" name="role" value="admin" class="hidden" <%= typeof selectedRole !== 'undefined' && selectedRole === 'admin' ? 'checked' : '' %>>
              <div class="role-icon w-12 h-12 bg-orange-50 text-orange-500 rounded-xl flex items-center justify-center mx-auto mb-2">
                <i class="fa-solid fa-user-shield text-lg"></i>
              </div>
              <span class="text-xs font-bold text-gray-700">Admin</span>
            </label>
          </div>
        </div>

        <!-- Username -->
        <div>
          <label class="text-xs font-semibold text-gray-500 uppercase tracking-wider mb-2 block">Username</label>
          <div class="relative">
            <i class="fa-solid fa-user absolute left-4 top-1/2 -translate-y-1/2 text-gray-400 text-sm"></i>
            <input type="text" name="username" placeholder="Masukkan username"
                   value="<%= typeof username !== 'undefined' ? username : '' %>"
                   class="w-full bg-slate-50 border border-gray-200 rounded-xl pl-11 pr-4 py-3 text-sm focus:outline-none focus:border-sma-grey focus:ring-2 focus:ring-sma-grey/20 transition-all" required>
          </div>
        </div>

        <!-- Password -->
        <div>
          <label class="text-xs font-semibold text-gray-500 uppercase tracking-wider mb-2 block">Password</label>
          <div class="relative">
            <i class="fa-solid fa-lock absolute left-4 top-1/2 -translate-y-1/2 text-gray-400 text-sm"></i>
            <input type="password" name="password" id="passwordInput" placeholder="Masukkan password"
                   class="w-full bg-slate-50 border border-gray-200 rounded-xl pl-11 pr-12 py-3 text-sm focus:outline-none focus:border-sma-grey focus:ring-2 focus:ring-sma-grey/20 transition-all" required>
            <button type="button" onclick="togglePassword()" class="absolute right-4 top-1/2 -translate-y-1/2 text-gray-400 hover:text-sma-grey transition-colors">
              <i id="eyeIcon" class="fa-solid fa-eye text-sm"></i>
            </button>
          </div>
        </div>

        <!-- Submit -->
        <button type="submit" class="w-full bg-sma-grey hover:bg-sma-dark text-white py-3.5 rounded-xl font-bold text-sm shadow-lg shadow-sma-grey/30 transition-all hover:shadow-glow flex items-center justify-center gap-2">
          <i class="fa-solid fa-arrow-right-to-bracket"></i> Masuk
        </button>
      </form>

      <!-- Demo Credentials -->
      <div class="mt-8 bg-slate-50 rounded-xl p-4 border border-slate-200">
        <h4 class="text-xs font-bold text-gray-500 uppercase tracking-wider mb-3">Demo Credentials</h4>
        <div class="space-y-2 text-xs text-gray-500">
          <div class="flex justify-between"><span class="font-medium">Admin:</span><span>admin / admin123</span></div>
          <div class="flex justify-between"><span class="font-medium">Guru:</span><span>budi.santoso / guru123</span></div>
          <div class="flex justify-between"><span class="font-medium">Siswa:</span><span>rizky.pratama / siswa123</span></div>
        </div>
      </div>

      <div class="mt-6 text-center">
        <a href="/" class="text-sm text-gray-400 hover:text-sma-grey transition-colors">
          <i class="fa-solid fa-arrow-left mr-1"></i> Kembali ke Beranda
        </a>
      </div>
    </div>
  </div>

  <script src="https://unpkg.com/aos@2.3.4/dist/aos.js"></script>
  <script>
    AOS.init({ duration: 600, once: true });

    function selectRole(el, role) {
      document.querySelectorAll('.role-card').forEach(function(c) { c.classList.remove('selected'); });
      el.classList.add('selected');
      el.querySelector('input[type="radio"]').checked = true;
    }

    function togglePassword() {
      var input = document.getElementById('passwordInput');
      var icon = document.getElementById('eyeIcon');
      if (input.type === 'password') {
        input.type = 'text';
        icon.classList.remove('fa-eye');
        icon.classList.add('fa-eye-slash');
      } else {
        input.type = 'password';
        icon.classList.remove('fa-eye-slash');
        icon.classList.add('fa-eye');
      }
    }

    // Auto-select role if query param exists
    var urlParams = new URLSearchParams(window.location.search);
    var roleParam = urlParams.get('role');
    if (roleParam) {
      var card = document.querySelector('input[value="' + roleParam + '"]');
      if (card) {
        card.checked = true;
        card.closest('.role-card').classList.add('selected');
      }
    }
  </script>
</body>
</html>
